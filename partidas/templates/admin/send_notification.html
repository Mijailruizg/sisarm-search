{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<div id="content-main">
    <h1>Enviar notificación por correo</h1>
    
    <form method="post" action="">
        {% csrf_token %}
        <div class="module">
            <h2>Confirmar envío de notificación</h2>
            <p>¿Estás seguro de que deseas enviar una notificación por correo a los siguientes usuarios?</p>
            
            <ul>
                {% for user in users %}
                    <li>{{ user.username }} ({{ user.email }})</li>
                {% endfor %}
            </ul>

            <div class="form-row">
                <label for="subject">Asunto:</label>
                <input type="text" name="subject" id="subject" value="{{ default_subject }}" style="width: 100%; max-width: 500px;">
            </div>

            <div class="form-row" style="margin-top: 1em;">
                <label for="message">Mensaje:</label>
                <textarea name="message" id="message" rows="5" style="width: 100%; max-width: 500px;">{{ default_message }}</textarea>
            </div>

            <div class="submit-row" style="margin-top: 1em;">
                <!-- marcar confirmación para la action -->
                <input type="hidden" name="post" value="yes">
                <!-- indicar el nombre de la acción para que Django la reconozca al reenviar -->
                <input type="hidden" name="action" value="enviar_notificacion_por_correo">
                {% for user_id in selected %}
                    <input type="hidden" name="_selected_action" value="{{ user_id }}">
                {% endfor %}
                <input type="submit" class="default" value="Enviar notificación">
                <a href="{% url 'admin:partidas_usuario_changelist' %}" class="button cancel-link">Cancelar</a>
            </div>
        </div>
    </form>
</div>
{% endblock %}